{% extends "layout.html" %}
{% block content %}

<h2 class="mb-4">ðŸ“Š Khana Khazana - Billing Report</h2>

<!-- FILTER -->
<div class="card shadow-sm p-3 mb-4">
    <form method="GET" class="row g-3">

        <div class="col-md-4">
            <label class="form-label">Month</label>
            <input name="month" value="{{ month }}" class="form-control" placeholder="MM">
        </div>

        <div class="col-md-4">
            <label class="form-label">Year</label>
            <input name="year" value="{{ year }}" class="form-control" placeholder="YYYY">
        </div>

        <div class="col-md-4">
            <button class="btn btn-primary w-100">
                Generate Report
            </button>
        </div>

    </form>
</div>

<!-- TOTAL COLLECTION -->
<div class="card shadow-sm p-4 mb-4 text-center bg-white">
    <h5>Total Collection</h5>
    <h1 class="text-success">â‚¹{{ monthly_total }}</h1>
</div>

<!-- BILLING TABLE -->
<div class="card shadow-sm p-3">
    <h5 class="mb-3">Member Billing Details</h5>

    <table class="table table-bordered table-hover">
        <thead class="table-dark">
            <tr>
                <th>Member Name</th>
                <th>Total Bill</th>
            </tr>
        </thead>
        <tbody>

        {% if data %}
            {% for row in data %}
            <tr>
                <td>{{ row[0] }}</td>
                <td>â‚¹{{ row[1] }}</td>
<td>
    <a href="/generate_bill/{{ row[2] }}" 
       class="btn btn-sm btn-primary">
       Generate Bill
    </a>
</td>
            </tr>
            {% endfor %}
        {% else %}
            <tr>
                <td colspan="2" class="text-center text-muted">
                    No billing data available
                </td>
            </tr>
        {% endif %}

        </tbody>
    </table>
</div>

<div class="mt-3">
    <a href="/export_excel" class="btn btn-success">
        â¬‡ Export Billing to Excel
    </a>
</div>

{% endblock %}